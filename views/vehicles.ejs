<%- include('partials/header') %>

<div class="row mb-4">
  <div class="col">
    <h2><i class="fas fa-car"></i> Vehicles</h2>
  </div>
  <% if (user.role === 'admin') { %>
  <div class="col text-end">
    <a href="/vehicles/add" class="btn btn-primary">
      <i class="fas fa-plus"></i> Add Vehicle
    </a>
  </div>
  <% } %>
</div>

<div class="card">
  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead class="table-dark">
          <tr>
            <th>Vehicle ID</th>
            <th>Brand</th>
            <th>Model</th>
            <th>Fuel</th>
            <th>Daily Rate</th>
            <th>Status</th>
            <% if (user.role === 'admin') { %>
            <th>Actions</th>
            <% } %>
          </tr>
        </thead>
        <tbody>
          <% if (vehicles.length === 0) { %>
            <tr>
              <td colspan="7" class="text-center">No vehicles found</td>
            </tr>
          <% } else { %>
            <% vehicles.forEach(vehicle => { %>
              <tr>
                <td><%= vehicle.vehicle_id %></td>
                <td><%= vehicle.brand %></td>
                <td><%= vehicle.model %></td>
                <td><%= vehicle.fuel %></td>
                <td>$<%= vehicle.daily_rate %></td>
                <td>
                  <% if (vehicle.availability === 'Available') { %>
                    <span class="badge bg-success">Available</span>
                  <% } else { %>
                    <span class="badge bg-danger">Rented</span>
                  <% } %>
                </td>
                <% if (user.role === 'admin') { %>
                <td>
                  <form action="/vehicles/delete/<%= vehicle._id %>" method="POST" class="d-inline" onsubmit="return confirm('Are you sure you want to delete this vehicle?');">
                    <button type="submit" class="btn btn-sm btn-danger">
                      <i class="fas fa-trash"></i> Delete
                    </button>
                  </form>
                </td>
                <% } %>
              </tr>
            <% }); %>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<%- include('partials/footer') %>